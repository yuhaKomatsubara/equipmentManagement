<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"> <!--thymeleafの宣言-->

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" th:href="@{/css/layout.css}">
	<title>貸出</title>
</head>

<body class="body">
	<h>備品貸出画面</h>
	<br>
	<a th:text="${detailName.equipmentName}"></a>
	<div class="fc_red" th:text="${errorMessage}"></div>

	<!-- 入れ子フォームを避けるため、テーブルとボタンを .table-wrapper に入れる -->
	<div class="table-wrapper">

		<!-- 貸出用フォーム（テーブル内の入力を送信） -->
		<form id="borrowForm" th:action="@{/borrowingProcess}" method="post"
			th:if="${itemDetail != null and !#lists.isEmpty(itemDetail)}">
			<input type="hidden" name="name" th:value="${detailName.equipmentName}">
			<table border="1">
				<tr class="front_label_color">
					<th>シリアルナンバー</th>
					<th>使用者</th>
					<th>貸出開始日</th>
					<th>返却予定日</th>
					<th>備考</th>
					<th>貸出</th>
				</tr>

				<tr th:each="item, stat : ${itemDetail}">
					<td th:text="${item.parentStockCode}"></td>

					<td>

						<!--<select name="staffNoList">（List使用時）-->
						<select th:name="|staffNoMap[${item.equipmentId}]|">
							<option value="">選択してください</option>
							<option th:each="staff : ${staffName}" th:value="${staff.staffNo}" th:text="${staff.name}"
								th:selected="${staffNoList != null and staffNoList[stat.index] == staff.staffNo}">
							</option>
						</select>
					</td>

					<td>
						<!--(List使用時)<input type="date" name="startDateList"
							th:value="${startDateList != null ? startDateList[stat.index] : today}">-->
						<input type="date" th:name="|startDateMap[${item.equipmentId}]|" th:value="${today}">
					</td>

					<td>
						<!--(List使用時)<input type="date" name="limitDateList"
							th:value="${limitDateList != null ? limitDateList[stat.index] : defaultLimit}">-->
						<input type="date" th:name="|limitDateMap[${item.equipmentId}]|" th:value="${defaultLimit}">
					</td>

					<td th:text="${item.remarks}"></td>

					<td>
						<input type="checkbox" name="equipmentIdList" th:value="${item.equipmentId}">
					</td>
				</tr>
			</table>
		</form>

		<!-- 戻る用フォーム（GET） -->
		<form id="backForm" th:action="@{/detailBack}" method="get">
			<input type="hidden" name="name" th:value="${detailName.equipmentName}">
		</form>

		<!-- ボタンはテーブルの下に配置。form属性でそれぞれのフォームに紐づける -->
		<div class="table-buttons">
			<button type="submit" form="borrowForm">貸出</button>
			<button type="submit" form="backForm">戻る</button>
		</div>

		<!-- 貸出できる備品がないとき -->
		<p th:if="${itemDetail == null or #lists.isEmpty(itemDetail)}">
			全て貸出中です
		</p>

	</div>


</body>

</html>